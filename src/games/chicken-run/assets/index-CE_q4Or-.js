(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();const h=960,o=540,l=430,d=1/60,c=160,v=58,p=48,E=2200,M=-760,w=280,C=14,y=760,_=100,O=[32,40,48],N=[52,68,84],m=420,R=.12,H=.08,D=.12,A=.08,g="chicken_run_best_score_v1";class G{constructor(){this.x=c,this.y=l-p,this.w=v,this.h=p,this.vy=0,this.grounded=!0}reset(){this.x=c,this.y=l-this.h,this.vy=0,this.grounded=!0}update(e,s){s&&this.grounded&&(this.vy=M,this.grounded=!1),this.vy+=E*e,this.y+=this.vy*e;const n=l-this.h;this.y>=n&&(this.y=n,this.vy=0,this.grounded=!0)}getHitbox(){const e=this.w*R,s=this.h*H;return{x:this.x+e,y:this.y+s,w:this.w-e*2,h:this.h-s*2}}render(e){const s=l-this.h,n=Math.max(0,s-this.y),i=this.grounded?Math.sin(performance.now()*.025)*2.6:-2,r=Math.max(.35,1-n/120);e.save(),e.translate(this.x,this.y),e.fillStyle=`rgba(37, 54, 32, ${.22*r})`,e.beginPath(),e.ellipse(this.w*.48,l-this.y+7,this.w*.43*r,7*r,0,0,Math.PI*2),e.fill();const a=e.createLinearGradient(0,0,0,this.h);a.addColorStop(0,"#ffe98a"),a.addColorStop(.55,"#f9d862"),a.addColorStop(1,"#efbd42"),e.fillStyle=a,e.beginPath(),e.roundRect(2,7,this.w-4,this.h-8,14),e.fill(),e.strokeStyle="#d19d2b",e.lineWidth=1.5,e.stroke(),e.fillStyle="#d39c2f",e.beginPath(),e.moveTo(3,this.h*.54),e.quadraticCurveTo(-8,this.h*.62,4,this.h*.74),e.quadraticCurveTo(10,this.h*.67,12,this.h*.56),e.closePath(),e.fill(),e.fillStyle="#d84c3f",e.beginPath(),e.moveTo(this.w*.52,8),e.quadraticCurveTo(this.w*.58,-4,this.w*.64,7),e.quadraticCurveTo(this.w*.58,13,this.w*.52,8),e.fill(),e.beginPath(),e.moveTo(this.w*.62,8),e.quadraticCurveTo(this.w*.68,-4,this.w*.74,7),e.quadraticCurveTo(this.w*.68,13,this.w*.62,8),e.fill(),e.fillStyle="#f1ba3f",e.beginPath(),e.ellipse(this.w*.48,this.h*.56,15,11+i*.2,-.22,0,Math.PI*2),e.fill(),e.strokeStyle="#dfab35",e.lineWidth=1.2,e.beginPath(),e.ellipse(this.w*.48,this.h*.56,15,11+i*.2,-.22,0,Math.PI*2),e.stroke(),e.fillStyle="#ffd86f",e.beginPath(),e.ellipse(this.w*.43,this.h*.52,6.5,4.8,-.2,0,Math.PI*2),e.fill(),e.fillStyle="#ff9e43",e.beginPath(),e.moveTo(this.w-4,this.h*.32),e.lineTo(this.w+12,this.h*.39),e.lineTo(this.w-4,this.h*.45),e.closePath(),e.fill(),e.fillStyle="#e07f32",e.beginPath(),e.moveTo(this.w-3,this.h*.42),e.lineTo(this.w+9,this.h*.46),e.lineTo(this.w-3,this.h*.5),e.closePath(),e.fill(),e.fillStyle="#fff",e.beginPath(),e.ellipse(this.w*.72,this.h*.27,4.8,4.2,0,0,Math.PI*2),e.fill(),e.fillStyle="#1f2530",e.beginPath(),e.arc(this.w*.73,this.h*.27,2.5,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(this.w*.745,this.h*.245,.9,0,Math.PI*2),e.fill(),e.strokeStyle="#be7326",e.lineWidth=3,e.lineCap="round",e.beginPath(),e.moveTo(this.w*.3,this.h-1),e.lineTo(this.w*.3+i,this.h+12),e.moveTo(this.w*.62,this.h-1),e.lineTo(this.w*.62-i,this.h+12),e.stroke(),e.strokeStyle="#c97e2e",e.lineWidth=2,e.beginPath(),e.moveTo(this.w*.3+i,this.h+12),e.lineTo(this.w*.24+i,this.h+14),e.moveTo(this.w*.3+i,this.h+12),e.lineTo(this.w*.34+i,this.h+14),e.moveTo(this.w*.62-i,this.h+12),e.lineTo(this.w*.56-i,this.h+14),e.moveTo(this.w*.62-i,this.h+12),e.lineTo(this.w*.66-i,this.h+14),e.stroke(),e.restore()}}function k(t,e,s,n=0){return{id:t,x:h+n,y:l-s,w:e,h:s,passed:!1}}function L(t){const e=t.w*D,s=t.h*A;return{x:t.x+e,y:t.y+s,w:t.w-e*2,h:t.h-s*2}}function F(t,e){t.save(),t.translate(e.x,e.y),t.fillStyle="#6f4e37",t.fillRect(0,0,e.w,e.h),t.fillStyle="#8a6241";const s=6;for(let n=5;n<e.h;n+=12)t.fillRect(1,n,e.w-2,s);t.fillStyle="#5e3f29",t.fillRect(3,0,5,e.h),t.fillRect(e.w-8,0,5,e.h),t.restore()}class Q{constructor(e){this.canvas=e,this.jumpQueued=!1,this.pauseQueued=!1,this.pointerQueued=!1,this.onKeyDown=s=>{if(!s.repeat){if(s.code==="Space"||s.code==="ArrowUp"){this.jumpQueued=!0,s.preventDefault();return}s.code==="KeyP"&&(this.pauseQueued=!0,s.preventDefault())}},this.onPointerDown=s=>{s.preventDefault(),this.jumpQueued=!0,this.pointerQueued=!0},window.addEventListener("keydown",this.onKeyDown),this.canvas.addEventListener("pointerdown",this.onPointerDown,{passive:!1})}destroy(){window.removeEventListener("keydown",this.onKeyDown),this.canvas.removeEventListener("pointerdown",this.onPointerDown)}poll(){const e={jumpPressed:this.jumpQueued,pausePressed:this.pauseQueued,pointerPressed:this.pointerQueued};return this.jumpQueued=!1,this.pauseQueued=!1,this.pointerQueued=!1,e}}function B(t,e){return Math.min(y,t+C*e)}function U(t,e,s){return s!=="running"?t:t+_*e}function S(t,e){const s=Math.floor(e()*t.length);return t[s]??t[t.length-1]}function K(t){let e=t>>>0;return e===0&&(e=1),()=>(e=e*1664525+1013904223>>>0,e/4294967296)}function X(t){const e=220+t*.45;return{min:e,max:e*1.75}}class j{constructor(e=Math.random){this.distanceUntilNext=m,this.nextObstacleId=1,this.random=e}reset(e){typeof e=="number"&&(this.random=K(e)),this.distanceUntilNext=m,this.nextObstacleId=1}sampleGap(e){const{min:s,max:n}=X(e);return s+(n-s)*this.random()}update(e,s){this.distanceUntilNext-=e*s;const n=[];for(;this.distanceUntilNext<=0;){const i=S(O,this.random),r=S(N,this.random);n.push(k(this.nextObstacleId,i,r,Math.max(0,this.distanceUntilNext))),this.nextObstacleId+=1,this.distanceUntilNext+=this.sampleGap(e)}return n}}let u=0;function T(){return typeof window<"u"&&typeof window.localStorage<"u"}function q(){if(!T())return u;try{const t=window.localStorage.getItem(g),e=t===null?0:Number.parseInt(t,10);return Number.isFinite(e)&&e>0?e:0}catch{return u}}function Y(t){const e=Math.max(0,Math.floor(t));if(u=Math.max(u,e),!!T())try{window.localStorage.setItem(g,String(e))}catch{}}function W(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}function $(t,e,s,n){t.save(),t.fillStyle="#11384d",t.font="700 28px Trebuchet MS",t.textAlign="left",t.fillText(`Score: ${Math.floor(s)}`,22,36),t.fillText(`Best: ${Math.floor(n)}`,22,70),e==="paused"&&(t.fillStyle="rgba(255, 255, 255, 0.84)",t.fillRect(0,0,h,o),t.fillStyle="#0f3448",t.textAlign="center",t.font="700 56px Trebuchet MS",t.fillText("Paused",h/2,o/2-16),t.font="600 24px Trebuchet MS",t.fillText("Press P or tap to continue",h/2,o/2+28)),t.restore()}function z(t){t.save(),t.fillStyle="rgba(12, 28, 42, 0.38)",t.fillRect(0,0,h,o),t.fillStyle="#fffdf6",t.textAlign="center",t.font="700 70px Trebuchet MS",t.fillText("Chicken Run",h/2,o/2-48),t.font="600 26px Trebuchet MS",t.fillText("Space / ArrowUp / Tap to jump and start",h/2,o/2+6),t.font="600 21px Trebuchet MS",t.fillText("Press P to pause while running",h/2,o/2+48),t.restore()}function V(t,e,s){t.save(),t.fillStyle="rgba(22, 16, 17, 0.58)",t.fillRect(0,0,h,o),t.fillStyle="#fff8e7",t.textAlign="center",t.font="700 62px Trebuchet MS",t.fillText("Game Over",h/2,o/2-40),t.font="600 30px Trebuchet MS",t.fillText(`Score: ${Math.floor(e)}`,h/2,o/2+8),t.fillText(`Best: ${Math.floor(s)}`,h/2,o/2+48),t.font="600 22px Trebuchet MS",t.fillText("Space or tap to restart",h/2,o/2+92),t.restore()}class J{constructor(e){this.canvas=e,this.chicken=new G,this.spawner=new j,this.state="menu",this.obstacles=[],this.score=0,this.bestScore=0,this.speed=w,this.worldDistance=0,this.frameId=0,this.lastTs=0,this.accumulator=0,this.onFrame=n=>{const i=Math.min((n-this.lastTs)/1e3,.1);for(this.lastTs=n,this.accumulator+=i;this.accumulator>=d;)this.tick(d),this.accumulator-=d;this.render(),this.frameId=requestAnimationFrame(this.onFrame)};const s=e.getContext("2d");if(!s)throw new Error("Unable to initialize 2D rendering context.");this.ctx=s,this.ctx.imageSmoothingEnabled=!0,this.bestScore=q(),this.input=new Q(this.canvas),this.resetRun(),this.state="menu"}start(){this.frameId===0&&(this.lastTs=performance.now(),this.frameId=requestAnimationFrame(this.onFrame))}stop(){this.frameId!==0&&(cancelAnimationFrame(this.frameId),this.frameId=0),this.input.destroy()}tick(e){const s=this.input.poll();if(this.state==="menu"){(s.jumpPressed||s.pointerPressed)&&this.startRun();return}if(this.state==="paused"){(s.pausePressed||s.pointerPressed)&&(this.state="running");return}if(this.state==="gameover"){(s.jumpPressed||s.pointerPressed)&&this.startRun();return}if(s.pausePressed){this.state="paused";return}this.speed=B(this.speed,e),this.speed=Math.min(this.speed,y),this.score=U(this.score,e,this.state),this.worldDistance+=this.speed*e,this.chicken.update(e,s.jumpPressed);const n=this.spawner.update(this.speed,e);n.length>0&&this.obstacles.push(...n);for(const r of this.obstacles)r.x-=this.speed*e;this.obstacles=this.obstacles.filter(r=>r.x+r.w>-4);const i=this.chicken.getHitbox();for(const r of this.obstacles)if(W(i,L(r))){this.toGameOver();return}}startRun(){this.resetRun(),this.state="running"}resetRun(){this.chicken.reset(),this.obstacles=[],this.spawner.reset(),this.score=0,this.speed=w,this.worldDistance=0}toGameOver(){this.state="gameover";const e=Math.floor(this.score);e>this.bestScore&&(this.bestScore=e,Y(e))}render(){this.renderBackground();for(const e of this.obstacles)F(this.ctx,e);this.chicken.render(this.ctx),$(this.ctx,this.state,this.score,this.bestScore),this.state==="menu"?z(this.ctx):this.state==="gameover"&&V(this.ctx,this.score,this.bestScore)}renderBackground(){const e=this.ctx.createLinearGradient(0,0,0,o);e.addColorStop(0,"#92d6ff"),e.addColorStop(1,"#e9f8ff"),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,h,o),this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.beginPath(),this.ctx.ellipse(160,94,72,26,0,0,Math.PI*2),this.ctx.ellipse(240,80,58,20,0,0,Math.PI*2),this.ctx.ellipse(710,124,84,30,0,0,Math.PI*2),this.ctx.fill();const s=-(this.worldDistance*.18)%60;this.ctx.fillStyle="rgba(82, 189, 113, 0.25)";for(let n=s;n<h+60;n+=60)this.ctx.fillRect(n,l+22,30,o-l-22);this.ctx.fillStyle="#58a95f",this.ctx.fillRect(0,l,h,o-l),this.ctx.fillStyle="#42944a",this.ctx.fillRect(0,l-6,h,8)}}const P=document.querySelector("#game");if(!P)throw new Error("Missing canvas element #game.");const f=P;f.width=h;f.height=o;function I(){const t=Math.min(window.innerWidth/h,window.innerHeight/o);f.style.width=`${Math.floor(h*t)}px`,f.style.height=`${Math.floor(o*t)}px`}window.addEventListener("resize",I);I();const b=new J(f);b.start();window.addEventListener("beforeunload",()=>{b.stop()});
