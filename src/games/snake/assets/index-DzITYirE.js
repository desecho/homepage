(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const h=24,g=24,a=20,l=h*a,f=g*a,A=140,N=75,L=5,F=3,P="snake.highScore.v1",H={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},K={up:"down",down:"up",left:"right",right:"left"};function I(e){return`${e.x},${e.y}`}function G(e){return e.x<0||e.y<0||e.x>=h||e.y>=g}function k(e,t){return e.x===t.x&&e.y===t.y}function W(){const e=Math.floor(h/2),t=Math.floor(g/2);return[{x:e,y:t},{x:e-1,y:t},{x:e-2,y:t}]}function Y(e,t){const s=Math.floor(e);return s<0?0:s>=t?t-1:s}function O(e,t=Math.random){const s=new Set(e.map(I)),i=[];for(let n=0;n<g;n+=1)for(let r=0;r<h;r+=1){const u={x:r,y:n};s.has(I(u))||i.push(u)}if(i.length===0)return null;const o=Y(t()*i.length,i.length);return i[o]}function B(e,t){return K[e]!==t}function T(e,t=Math.random){const s=W(),i=O(s,t)??{x:0,y:0};return{snake:s,direction:"right",queuedDirection:null,food:i,score:0,highScore:e,status:"ready",tickMs:A}}function U(e,t){e.status!=="gameover"&&e.queuedDirection===null&&B(e.direction,t)&&(e.queuedDirection=t,e.status==="ready"&&(e.status="running"))}function V(e){if(e.status==="running"){e.status="paused";return}e.status==="paused"&&(e.status="running")}function $(e){return e.queuedDirection??e.direction}function X(e,t=Math.random){if(e.status!=="running")return e;const s=$(e),i=H[s],o=e.snake[0],n={x:o.x+i.x,y:o.y+i.y},r=k(n,e.food),u=r?e.snake:e.snake.slice(0,-1);if(G(n)||u.some(S=>k(S,n)))return{...e,direction:s,queuedDirection:null,status:"gameover"};const m=[n,...e.snake];let y=e.score,x=e.food,E=e.tickMs,D=e.status;if(r){y+=1,y%F===0&&(E=Math.max(N,e.tickMs-L));const S=O(m,t);S===null?D="gameover":x=S}else m.pop();return{...e,snake:m,direction:s,queuedDirection:null,food:x,score:y,highScore:Math.max(e.highScore,y),status:D,tickMs:E}}function Z(e,t=Math.random){return T(e,t)}const j={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",w:"up",W:"up",s:"down",S:"down",a:"left",A:"left",d:"right",D:"right"},z=new Set(["Enter","r","R"]);function J(e,t){const s=i=>{const o=j[i.key];if(o){i.preventDefault(),t.onDirection(o);return}if(i.code==="Space"){i.preventDefault(),t.onPause();return}z.has(i.key)&&t.onRestart()};return e.addEventListener("keydown",s),()=>{e.removeEventListener("keydown",s)}}function R(e,t,s){const i=t.x*a,o=t.y*a;e.fillStyle=s,e.fillRect(i+1,o+1,a-2,a-2)}function Q(e){e.width=l,e.height=f;const t=e.getContext("2d");if(!t)throw new Error("2D rendering context is unavailable");t.imageSmoothingEnabled=!1;const s=()=>{t.strokeStyle="#21364f",t.lineWidth=1;for(let n=0;n<=h;n+=1){const r=n*a+.5;t.beginPath(),t.moveTo(r,0),t.lineTo(r,f),t.stroke()}for(let n=0;n<=g;n+=1){const r=n*a+.5;t.beginPath(),t.moveTo(0,r),t.lineTo(l,r),t.stroke()}},i=n=>{let r="",u="";n.status==="ready"?(r="Ready",u="Press an arrow key or WASD"):n.status==="paused"?(r="Paused",u="Press Space to continue"):n.status==="gameover"&&(r="Game Over",u="Press Enter or R to restart"),r&&(t.fillStyle="#000000aa",t.fillRect(0,0,l,f),t.fillStyle="#d9f0ff",t.textAlign="center",t.font="bold 28px Courier New",t.fillText(r,l/2,f/2-10),t.fillStyle="#a9cbe8",t.font="16px Courier New",t.fillText(u,l/2,f/2+20))};return{render:n=>{t.fillStyle="#071625",t.fillRect(0,0,l,f),s(),R(t,n.food,"#ff5f7d");for(let r=n.snake.length-1;r>=0;r-=1){const u=n.snake[r];R(t,u,r===0?"#b2ffd0":"#80f4b3")}i(n)}}}function ee(){try{const e=window.localStorage.getItem(P);if(e===null)return 0;const t=Number.parseInt(e,10);return Number.isFinite(t)&&t>=0?t:0}catch{return 0}}function te(e){try{window.localStorage.setItem(P,String(e))}catch{}}const b=document.querySelector("#game"),_=document.querySelector("#score"),v=document.querySelector("#high-score"),C=document.querySelector("#status-text");if(!b||!_||!v||!C)throw new Error("Game DOM structure is incomplete");const ne=_,re=v,oe=C,p=Q(b);let c=T(ee());function ie(e){return e.status==="ready"?"Press an arrow key or WASD to start":e.status==="paused"?"Paused. Press Space to continue":e.status==="gameover"?"Game over. Press Enter or R to restart":"Running"}function w(e){ne.textContent=String(e.score),re.textContent=String(e.highScore),oe.textContent=ie(e)}function se(){c=Z(c.highScore),w(c),p.render(c)}const ce=J(window,{onDirection(e){U(c,e)},onPause(){V(c)},onRestart(){(c.status==="running"||c.status==="paused"||c.status==="gameover")&&se()}});window.addEventListener("beforeunload",()=>{ce()});let M=performance.now(),d=0;function q(e){const t=e-M;if(M=e,c.status==="running")for(d+=t;d>=c.tickMs;){const s=c.tickMs,i=c.highScore;if(c=X(c),c.highScore>i&&te(c.highScore),d-=s,c.status!=="running"){d=0;break}}else d=0;w(c),p.render(c),window.requestAnimationFrame(q)}w(c);p.render(c);window.requestAnimationFrame(q);
